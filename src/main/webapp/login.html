<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>登陆界面</title>
<style type="text/css">
<!--
body {
	margin-left: 0px;
	margin-top: 0px;
	margin-right: 0px;
	margin-bottom: 0px;
	overflow:hidden;
}
-->
</style>
<link rel="stylesheet" type="text/css" href="extjs/resources/css/ext-all.css">
  <script type="text/javascript" charset="utf-8" src="extjs/ext-all-debug.js"></script>
  <script type="text/javascript" src="extjs/ext-lang-zh_CN.js"></script>
<script type="text/JavaScript">
</script>
</head>

<body onLoad="MM_preloadImages('images/login_09_1.gif','images/login_10_1.gif')">
<table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
  <tr>
    <td bgcolor="#02395f">&nbsp;</td>
  </tr>
  <tr>
    <td height="607" align="center" background="images/login_02.gif"><table width="974" border="0" cellspacing="0" cellpadding="0">
      <tr>
        <td height="331" background="images/login_01.jpg">&nbsp;</td>
      </tr>
      <tr>
        <td height="116"><table width="100%" border="0" cellspacing="0" cellpadding="0">
          <tr>
            <td width="393" height="116" background="images/login_05.gif">&nbsp;</td>
            <td width="174"><table width="100%" border="0" cellspacing="0" cellpadding="0">
              <tr>
                <td height="81" background="images/login_06.gif"><table width="100%" border="0" cellspacing="0" cellpadding="0">
                  <tr>
                    <td width="30%"><div align="center"><font style="height:1;font-size:9pt; color:#bfdbeb;filter:glow(color=#1070a3,strength=1)">用户</font></div></td>
                    <td><div id="user"></div></td>
                  </tr>
                  <tr height="10"></tr>
                  <tr>
                    <td><div align="center"><font style="height:1;font-size:9pt; color:#bfdbeb;filter:glow(color=#1070a3,strength=1)">密码</font></div></td>
                    <td><div id="pwd"></div></td>
                  </tr>
                </table></td>
              </tr>
              <tr>
                <td height="35"><table width="100%" border="0" cellspacing="0" cellpadding="0">
                  <tr>
                    <td width="50" height="35"><img src="images/login_08.gif" width="50" height="35"></td>
                    <td width="46"><a href="#"><img src="images/login_09.gif" name="Image1" width="46" height="35" border="0" id="Image1" onMouseOver="MM_swapImage('Image1','','images/login_09_1.gif',1)" onMouseOut="MM_swapImgRestore()" onclick="login()"></a></td>
                    <td width="45"><a href="#"><img src="images/login_10.gif" name="Image2" width="45" height="35" border="0" id="Image2" onMouseOver="MM_swapImage('Image2','','images/login_10_1.gif',1)" onMouseOut="MM_swapImgRestore()" onclick="reset()"></a></td>
                    <td width="33"><img src="images/login_11.gif" width="33" height="35"></td>
                  </tr>
                </table></td>
              </tr>
            </table></td>
            <td width="407" background="images/login_07.gif">
				<div id="loginBtn"></div>
			</td>
          </tr>
        </table></td>
      </tr>
      <tr>
        <td height="160" background="images/login_12.gif">
			<div id="resetBtn"></div>
		</td>
      </tr>
    </table></td>
  </tr>
  <tr>
    <td bgcolor="#02609c">&nbsp;</td>
  </tr>
</table>
</body>
</html>
<script>
var loginMask,userName,pwd;
Ext.onReady(function() {
    Ext.tip.QuickTipManager.init();
    loginMask=new Ext.LoadMask(Ext.getBody(),{msg:'正在登录，请稍后...'});
    
    //用户名文本框
    userName=new Ext.form.TextField({
		renderTo:'user',
		name:'userName',
		allowBlank:false,
		listeners:{
			specialkey:function(field,e){
				if(e.getKey()==13){
					loginBtn.fireEvent('click',loginBtn);
				}
			}
		}
    });
    
    //密码文本框
    pwd=new Ext.form.TextField({
		renderTo:'pwd',
		name:'password',
		inputType:'password',
		allowBlank:false,
		listeners:{
			specialkey:function(field,e){
				if(e.getKey()==13){
					loginBtn.fireEvent('click',loginBtn);
				}
			}
		}
    });
    

    
});

function login(){
	var params={
			userName:userName.getValue(),
			password:pwd.getValue()
		};
		
		if(params.userName==''){
			//MsgTip.msg('请输入用户名','');
			userName.focus();
			return;
		}
		
		if(params.password==''){
			//MsgTip.msg('请输入用户名','');
			pwd.focus();
			return;
		}
		loginMask.show();
		
		Ext.Ajax.request({
			url : 'staff_login.action',
			method : 'POST',
			customer:'自定义属性',
			params : params,
//			callback:function(options,success,response){
//				var msg=['请求是否成功：',success,"\n",
//				'服务器返回值：',response.responseText,
//				'本地自定义属性：',options.customer];
//				alert(msg.join(''));
//			},
			success : function(response,o) {
				// 处理返回信息
				var result=Ext.JSON.decode(response.responseText);
				if (result.success) {
					window.top.location = result.msg;
				} else {
					top.Ext.Msg.show({title:'提示', msg:'用户名或密码错误！',icon:Ext.Msg.INFO,buttons:Ext.Msg.OK});
					//隐藏mask
					loginMask.hide();
				}
			},
			failure : function() {
				//隐藏mask
				loginMask.hide();
				//显示错误信息
				Ext.example.msg('登录失败','网络故障');
			}
		});
	}

function reset(){
	userName.setValue('admin');
	pwd.setValue('admin');
}
</script>